<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>test.cpp</title>
<meta name="Generator" content="SciTE - www.Scintilla.org" />
<style type="text/css">
.S0 {
	color: #808080;
	font-size: 10pt;
}
.S4 {
	color: #007F7F;
	font-size: 10pt;
}
.S5 {
	font-weight: bold;
	color: #00007F;
	font-size: 10pt;
}
.S6 {
	color: #7F007F;
	font-size: 10pt;
}
.S9 {
	color: #7F7F00;
	font-size: 10pt;
}
.S10 {
	font-weight: bold;
	color: #000000;
	font-size: 10pt;
}
span {
	font-family: 'Verdana';
	color: #000000;
	font-size: 9pt;
}
</style>
</head>
<body bgcolor="#FFFFFF">
<span><span class="S9">#include "cgi.h"</span><br />
<br />
<span class="S5">using</span><span class="S0"> </span>VUint<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>std<span class="S10">::</span>vector<span class="S10">&lt;</span>uint32_t<span class="S10">&gt;;</span><br />
<br />
VUint<span class="S0"> </span>utf8ToVector<span class="S10">(</span>std<span class="S10">::</span>string<span class="S0"> </span><span class="S5">const</span><span class="S0"> </span><span class="S10">&amp;</span>s<span class="S10">,</span><span class="S0"> </span><span class="S5">bool</span><span class="S0"> </span>sort<span class="S10">)</span><span class="S0"> </span><span class="S10">{</span><br />
<span class="S0">&nbsp; </span>VUint<span class="S0"> </span>v<span class="S10">;</span><br />
<span class="S0">&nbsp; </span>uint32_t<span class="S0"> </span>b<span class="S10">;</span><br />
<span class="S0">&nbsp; </span><span class="S5">int</span><span class="S0"> </span>i<span class="S10">;</span><br />
<span class="S0">&nbsp; </span><span class="S5">const</span><span class="S0"> </span>uint8_t<span class="S0"> </span><span class="S10">*</span>p<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S10">(</span><span class="S5">const</span><span class="S0"> </span>uint8_t<span class="S10">*)</span><span class="S0"> </span>s<span class="S10">.</span>c_str<span class="S10">();</span><br />
<span class="S0">&nbsp; </span><span class="S5">while</span><span class="S0"> </span><span class="S10">(*</span>p<span class="S10">)</span><span class="S0"> </span><span class="S10">{</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">if</span><span class="S0"> </span><span class="S10">((*</span>p<span class="S0"> </span><span class="S10">&amp;</span><span class="S0"> </span><span class="S4">0x80</span><span class="S10">)</span><span class="S0"> </span><span class="S10">==</span><span class="S0"> </span><span class="S4">0</span><span class="S10">)</span><span class="S0"> </span><span class="S10">{</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; </span>i<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S4">0</span><span class="S10">;</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S10">}</span><span class="S0"> </span><span class="S5">else</span><span class="S0"> </span><span class="S5">if</span><span class="S0"> </span><span class="S10">((*</span>p<span class="S0"> </span><span class="S10">&amp;</span><span class="S0"> </span><span class="S4">0xE0</span><span class="S10">)</span><span class="S0"> </span><span class="S10">==</span><span class="S0"> </span><span class="S4">0xC0</span><span class="S10">)</span><span class="S0"> </span><span class="S10">{</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; </span>i<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S4">1</span><span class="S10">;</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S10">}</span><span class="S0"> </span><span class="S5">else</span><span class="S0"> </span><span class="S5">if</span><span class="S0"> </span><span class="S10">((*</span>p<span class="S0"> </span><span class="S10">&amp;</span><span class="S0"> </span><span class="S4">0xF0</span><span class="S10">)</span><span class="S0"> </span><span class="S10">==</span><span class="S0"> </span><span class="S4">0xE0</span><span class="S10">)</span><span class="S0"> </span><span class="S10">{</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; </span>i<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S4">2</span><span class="S10">;</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S10">}</span><span class="S0"> </span><span class="S5">else</span><span class="S0"> </span><span class="S5">if</span><span class="S0"> </span><span class="S10">((*</span>p<span class="S0"> </span><span class="S10">&amp;</span><span class="S0"> </span><span class="S4">0xF8</span><span class="S10">)</span><span class="S0"> </span><span class="S10">==</span><span class="S0"> </span><span class="S4">0xF0</span><span class="S10">)</span><span class="S0"> </span><span class="S10">{</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; </span>i<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S4">3</span><span class="S10">;</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S10">}</span><span class="S0"> </span><span class="S5">else</span><span class="S0"> </span><span class="S10">{</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; </span>std<span class="S10">::</span>cerr<span class="S0"> </span><span class="S10">&lt;&lt;</span><span class="S0"> </span><span class="S6">"Unrecognized lead byte ("</span><span class="S0"> </span><span class="S10">&lt;&lt;</span><span class="S0"> </span>std<span class="S10">::</span>hex<span class="S0"> </span><span class="S10">&lt;&lt;</span><span class="S0"> </span><span class="S10">*</span>p<span class="S0"> </span><span class="S10">&lt;&lt;</span><span class="S0"> </span><span class="S6">")"</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S10">&lt;&lt;</span><span class="S0"> </span>std<span class="S10">::</span>endl<span class="S10">;</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; </span><span class="S5">break</span><span class="S10">;</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S10">}</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">for</span><span class="S0"> </span><span class="S10">(</span>b<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S4">0</span><span class="S10">;</span><span class="S0"> </span>i<span class="S0"> </span><span class="S10">&gt;=</span><span class="S0"> </span><span class="S4">0</span><span class="S10">;</span><span class="S0"> </span>i<span class="S10">--)</span><span class="S0"> </span><span class="S10">{</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; </span>b<span class="S0"> </span><span class="S10">|=</span><span class="S0"> </span><span class="S10">*</span>p<span class="S10">++</span><span class="S0"> </span><span class="S10">&lt;&lt;</span><span class="S0"> </span><span class="S10">(</span>i<span class="S0"> </span><span class="S10">*</span><span class="S0"> </span><span class="S4">8</span><span class="S10">);</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S10">}</span><br />
<span class="S0">&nbsp; &nbsp; </span>v<span class="S10">.</span>push_back<span class="S10">(</span>b<span class="S10">);</span><br />
<span class="S0">&nbsp; </span><span class="S10">}</span><br />
<span class="S0">&nbsp; </span><span class="S5">if</span><span class="S0"> </span><span class="S10">(</span>sort<span class="S10">)</span><span class="S0"> </span><span class="S10">{</span><br />
<span class="S0">&nbsp; &nbsp; </span>std<span class="S10">::</span>sort<span class="S10">(</span>v<span class="S10">.</span>begin<span class="S10">(),</span><span class="S0"> </span>v<span class="S10">.</span>end<span class="S10">());</span><br />
<span class="S0">&nbsp; </span><span class="S10">}</span><br />
<span class="S0">&nbsp; </span><span class="S5">return</span><span class="S0"> </span>v<span class="S10">;</span><br />
<span class="S10">}</span><br />
<br />
<span class="S5">int</span><span class="S0"> </span>main<span class="S10">()</span><span class="S0"> </span><span class="S10">{</span><br />
<span class="S0">&nbsp; </span>VUint<span class="S0"> </span>t<span class="S10">[</span><span class="S4">2</span><span class="S10">];</span><br />
<span class="S0">&nbsp; </span><span class="S5">int</span><span class="S0"> </span>i<span class="S10">;</span><br />
<span class="S0">&nbsp; </span>Cgi<span class="S0"> </span>c<span class="S10">;</span><br />
<br />
<span class="S0">&nbsp; </span><span class="S5">if</span><span class="S0"> </span><span class="S10">(!</span>c<span class="S10">.</span>ok<span class="S10">())</span><span class="S0"> </span><span class="S10">{</span><br />
<span class="S0">&nbsp; &nbsp; </span>std<span class="S10">::</span>cout<span class="S0"> </span><span class="S10">&lt;&lt;</span><span class="S0"> </span>c<span class="S10">.</span>getErrorMessage<span class="S10">()</span><span class="S0"> </span><span class="S10">&lt;&lt;</span><span class="S0"> </span>std<span class="S10">::</span>endl<span class="S10">;</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">return</span><span class="S0"> </span><span class="S4">1</span><span class="S10">;</span><br />
<span class="S0">&nbsp; </span><span class="S10">}</span><br />
<br />
<span class="S0">&nbsp; </span>std<span class="S10">::</span>cout<span class="S0"> </span><span class="S10">&lt;&lt;</span><span class="S0"> </span>c<span class="S10">.</span>m_method<span class="S0"> </span><span class="S10">&lt;&lt;</span><span class="S0"> </span><span class="S6">"{"</span><span class="S0"> </span><span class="S10">&lt;&lt;</span><span class="S0"> </span>std<span class="S10">::</span>endl<span class="S10">;</span><br />
<span class="S0">&nbsp; </span><span class="S5">for</span><span class="S0"> </span><span class="S10">(</span><span class="S5">auto</span><span class="S0"> </span>a<span class="S0"> </span><span class="S10">:</span><span class="S0"> </span>c<span class="S10">)</span><span class="S0"> </span><span class="S10">{</span><br />
<span class="S0">&nbsp; &nbsp; </span>std<span class="S10">::</span>cout<span class="S0"> </span><span class="S10">&lt;&lt;</span><span class="S0"> </span>a<span class="S10">.</span>first<span class="S0"> </span><span class="S10">&lt;&lt;</span><span class="S0"> </span><span class="S6">"="</span><span class="S0"> </span><span class="S10">&lt;&lt;</span><span class="S0"> </span>a<span class="S10">.</span>second<span class="S0"> </span><span class="S10">&lt;&lt;</span><span class="S0"> </span>std<span class="S10">::</span>endl<span class="S10">;</span><br />
<span class="S0">&nbsp; </span><span class="S10">}</span><br />
<span class="S0">&nbsp; </span>std<span class="S10">::</span>cout<span class="S0"> </span><span class="S10">&lt;&lt;</span><span class="S0"> </span><span class="S6">"}"</span><span class="S10">;</span><br />
<br />
<span class="S0">&nbsp; </span><span class="S5">if</span><span class="S0"> </span><span class="S10">(</span>c<span class="S10">.</span>size<span class="S10">()</span><span class="S0"> </span><span class="S10">&lt;</span><span class="S0"> </span><span class="S4">2</span><span class="S10">)</span><span class="S0"> </span><span class="S10">{</span><br />
<span class="S0">&nbsp; &nbsp; </span>std<span class="S10">::</span>cout<span class="S0"> </span><span class="S10">&lt;&lt;</span><span class="S0"> </span><span class="S6">"too few parameters"</span><span class="S10">;</span><br />
<span class="S0">&nbsp; </span><span class="S10">}</span><span class="S0"> </span><span class="S5">else</span><span class="S0"> </span><span class="S10">{</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">for</span><span class="S0"> </span><span class="S10">(</span>i<span class="S0"> </span><span class="S10">=</span><span class="S0"> </span><span class="S4">0</span><span class="S10">;</span><span class="S0"> </span>i<span class="S0"> </span><span class="S10">&lt;</span><span class="S0"> </span><span class="S4">2</span><span class="S10">;</span><span class="S0"> </span>i<span class="S10">++)</span><span class="S0"> </span><span class="S10">{</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; </span>t<span class="S10">[</span>i<span class="S10">]</span><span class="S0"> </span><span class="S10">=</span><span class="S0"> </span>utf8ToVector<span class="S10">(</span>c<span class="S10">.</span>value<span class="S10">(</span>i<span class="S10">),</span><span class="S0"> </span><span class="S5">true</span><span class="S10">);</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S10">}</span><br />
<span class="S0">&nbsp; &nbsp; </span>std<span class="S10">::</span>cout<span class="S0"> </span><span class="S10">&lt;&lt;</span><span class="S0"> </span><span class="S6">" "</span><span class="S0"> </span><span class="S10">&lt;&lt;</span><span class="S0"> </span><span class="S10">(</span>t<span class="S10">[</span><span class="S4">0</span><span class="S10">]</span><span class="S0"> </span><span class="S10">==</span><span class="S0"> </span>t<span class="S10">[</span><span class="S4">1</span><span class="S10">]);</span><br />
<span class="S0">&nbsp; </span><span class="S10">}</span><br />
<span class="S10">}</span><br />
<span class="S0"></span></span>
</body>
</html>
